# Проект на тему : "Замена оборудования с применением альтернативных протоколов и оптимизация линий связи в модернизируемой сети компании"

### В статье представлено более детальное описание проекта, чем в [презентации.](ссылка на презентацию), и раскрыта конфигурация используемого оборудования.

### Исследуемая схема

![Исследуемая схема](https://github.com/Pekep97/Labs/blob/main/Lab_04/Lab_04.png)

### Таблица адресного пространства:

|              |            |                 | *Москва*        |                       |             |                     |             |                |
|--------------|------------|-----------------|---------------|-----------------------|-------------|---------------------|-------------|----------------|
| Hostname     | Interfaces | Description     | IPv4-address  | Mask                  | Gateway     | IPv6-address        | IPv6-prefix | LLIPv6-address |
| R12          | e0/0.100   | MANAGEMENT_MSK  | 10.58.100.2   | 255.255.255.0 (/24)   | -           | fd00:10:58:100::1   | /64         | fe80::1        |
|              | e0/1.10    | DHCP_MSK        | 192.168.10.3  | 255.255.255.0 (/24)   | -           | fd00:192:168:10::1  | /64         | fe80::1        |
|              | e0/2       | l3:to-R14       | 10.64.100.1   | 255.255.255.252 (/30) | -           | fd00:0:12:14::1     | /112        | fe80::1        |
|              | e0/3       | l3:to-R15       | 10.64.100.5   | 255.255.255.252 (/30) | -           | fd00:0:12:15::1     | /112        | fe80::1        |
|              | Loopback0  | -               | 172.16.255.12   | 255.255.255.255(/32)  | -           |   |         |         |
| R13          | e0/0.100   | MANAGEMENT_MSK  | 10.58.100.4   | 255.255.255.0 (/24)   | -           | fd00:10:58:100::1   | /64         | fe80::100      |
|              | e0/1.10    | DHCP_MSK        | 192.168.10.5  | 255.255.255.0 (/24)   | -           | fd00:192:168:10::1  | /64         | fe80::10       |
|              | e0/2       | l3:to-R15       | 10.64.100.13  | 255.255.255.252 (/30) | -           | fd00:0:13:15::1     | /112        | fe80::1        |
|              | e0/3       | l3:to-R14       | 10.64.100.9   | 255.255.255.252 (/30) | -           | fd00:0:13:14::1     | /112        | fe80::1        |
|              | Loopback0  | -               | 172.16.255.13   | 255.255.255.255(/32)  | -           |   |         |         |
| VRRP_R12+R13 | -          | MANAGEMENT_MSK  | 10.58.100.1   | 255.255.255.0 (/24)   | -           | -                   | -           | -              |
|              | -          | DHCP_MSK        | 192.168.10.1  | 255.255.255.0 (/24)   | -           | -                   | -           | -              |
| R14          | e0/0       | l3:to-R12       | 10.64.100.2   | 255.255.255.252 (/30) | -           | fd00:0:12:14::2     | /112        | fe80::2        |
|              | e0/1       | l3:to-R13       | 10.64.100.13  | 255.255.255.252 (/30) | -           | fd00:0:13:14::2     | /112        | fe80::2        |
|              | e0/2       | l3:to-AS-101    | 85.10.22.2    | 255.255.255.252 (/30) | -           | 2000:0:1001:101::2  | /112        | fe80::2        |
|              | e0/3       | l3:to-R19       | 10.64.100.21  | 255.255.255.252 (/30) | -           | fd00:0:14:19::1     | /112        | fe80::2        |
|              | Loopback0  | -               | 172.16.255.14   | 255.255.255.255(/32)  | -           | fd00:172:16:255::14   | /128        | fe80::1        |
|              | Loopback1  | to_NAT               | 49.28.35.14   | 255.255.255.0(/24)  | -           |   |         |         |
| R15          | e0/0       | l3:to-R13       | 10.64.100.14  | 255.255.255.252 (/30) | -           | fd00:0:13:15::2     | /112        | fe80::2        |
|              | e0/1       | l3:to-R12       | 10.64.100.6   | 255.255.255.252 (/30) | -           | fd00:0:12:15::2     | /112        | fe80::2        |
|              | e0/2       | l3:to-AS-301    | 132.50.21.2   | 255.255.255.252 (/30) | -           | 2000:0:1001:301::2  | /112        | fe80::2        |
|              | e0/3       | l3:to-R20       | 10.64.100.17  | 255.255.255.252 (/30) | -           | fd00:0:15:20::1     | /112        | fe80::2        |
|              | Loopback0  | -               | 172.16.255.15   | 255.255.255.255(/32)  | -           | fd00:172:16:255::15   | /128        | fe80::1        |
|              | Loopback1  | to_NAT               | 37.85.13.15   | 255.255.255.0(/24)  | -           |   |         |         |
|              | Tunnel0  | -               | 10.0.0.1   | 255.255.255.0(/24)  | -           |   |         |         |
|              | Tunnel1  | -               | 10.0.1.1   | 255.255.255.0(/24)  | -           |   |         |         |
| R19          | e0/0       | l3:to-R14       | 10.64.100.22  | 255.255.255.252 (/30) | -           | fd00:0:14:19::2     | /112        | fe80::1        |
| R20          | e0/0       | l3:to-R15       | 10.64.100.18  | 255.255.255.252 (/30) | -           | fd00:0:15:20::2     | /112        | fe80::1        |
| SW2          | VLAN100    | MANAGEMENT_MSK  | 10.58.100.12  | 255.255.255.0 (/24)   | 10.58.100.1 | fd00:10:58:100::2   | /64         | fe80::2        |
| SW3          | VLAN100    | MANAGEMENT_MSK  | 10.58.100.13  | 255.255.255.0 (/24)   | 10.58.100.1 | fd00:10:58:100::3   | /64         | fe80::3        |
| SW4          | VLAN100    | MANAGEMENT_MSK  | 10.58.100.14  | 255.255.255.0 (/24)   | 10.58.100.1 | fd00:10:58:100::4   | /64         | fe80::4        |
| SW5          | VLAN100    | MANAGEMENT_MSK  | 10.58.100.15  | 255.255.255.0 (/24)   | 10.58.100.1 | fd00:10:58:100::5   | /64         | fe80::5        |
| VPC1         | NIC        | -               | DHCP          | DHCP                  | DHCP        | -                   | -           | -              |
| VPC2         | NIC        | -               | DHCP          | DHCP                  | DHCP        | -                   | -           | -              |
|              |            |                 | *Киторн*        |                       |             |                     |             |                |
| Hostname     | Interfaces | Description     | IPv4-address  | Mask                  | Gateway     | IPv6-address        | IPv6-prefix | LLIPv6-address |
| R22          | e0/0       | l3:to-AS-1001   | 85.10.22.1    | 255.255.255.252 (/30) | -           | 2000:0:1001:101::1  | /112        | fe80::1        |
|              | e0/1       | l3:to-AS-301    | 21.22.100.1   | 255.255.255.252 (/30) | -           | 2000:0:301:101::1   | /112        | fe80::2        |
|              | e0/2       | l3:to-AS-520    | 23.100.40.2   | 255.255.255.252 (/30) | -           | 2000:0:520:101::2   | /112        | fe80::1        |
|              |            |                 | *Ламас*         |                       |             |                     |             |                |
| Hostname     | Interfaces | Description     | IPv4-address  | Mask                  | Gateway     | IPv6-address        | IPv6-prefix | LLIPv6-address |
| R21          | e0/0       | l3:to-AS-1001   | 132.50.21.1   | 255.255.255.252 (/30) | -           | 2000:0:1001:301::1  | /112        | fe80::1        |
|              | e0/1       | l3:to-AS-101    | 21.22.100.2   | 255.255.255.252 (/30) | -           | 2000:0:301:101::2   | /112        | fe80::1        |
|              | e0/2       | l3:to-AS-520    | 24.100.40.2   | 255.255.255.252 (/30) | -           | 2000:0:520:301::2   | /112        | fe80::1        |
|              |            |                 | *Триада*        |                       |             |                     |             |                |
| Hostname     | Interfaces | Description     | IPv4-address  | Mask                  | Gateway     | IPv6-address        | IPv6-prefix | LLIPv6-address |
| R23          | e0/0       | l3:to-AS-101    | 23.100.40.1   | 255.255.255.252 (/30) | -           | 2000:0:520:101::1   | /112        | fe80::2        |
|              | e0/1       | l3:to-R25       | 10.64.52.1    | 255.255.255.252 (/30) | -           | fd00:0:23:25::1     | /112        | fe80::1        |
|              | e0/2       | l3:to-R24       | 10.64.52.5    | 255.255.255.252 (/30) | -           | fd00:0:23:24::1     | /112        | fe80::1        |
|              | Loopback0  | -               | 172.16.255.23   | 255.255.255.255(/32)  | -           | fd00:172:16:255::23   | /128        | fe80::1        |
| R24          | e0/0       | l3:to-AS-301    | 24.100.40.1   | 255.255.255.252 (/30) | -           | 2000:0:520:301::1   | /112        | fe80::2        |
|              | e0/1       | l3:to-R26       | 10.64.52.9    | 255.255.255.252 (/30) | -           | fd00:0:24:26::1     | /112        | fe80::2        |
|              | e0/2       | l3:to-R23       | 10.64.52.6    | 255.255.255.252 (/30) | -           | fd00:0:23:24::2     | /112        | fe80::2        |
|              | e0/3       | l3:to-AS-2042   | 24.100.40.5   | 255.255.255.252 (/30) | -           | 2000:0:520:2042::1  | /112        | fe80::2        |
|              | Loopback0  | -               | 172.16.255.24   | 255.255.255.255(/32)  | -           | fd00:172:16:255::24   | /128        | fe80::1        |
| R25          | e0/0       | l3:to-R23       | 10.64.52.2    | 255.255.255.252 (/30) | -           | fd00:0:23:25::2     | /112        | fe80::2        |
|              | e0/1       | l3:to-LBTNG     | 1.1.1.2       | 255.255.255.252 (/30) | -           | 2000:0:520:1111::2  | /112        | fe80::2        |
|              | e0/2       | l3:to-R26       | 10.64.52.13   | 255.255.255.252 (/30) | -           | fd00:0:25:26::1     | /112        | fe80::2        |
|              | e0/3       | l3:to-CHKR      | 2.2.2.2       | 255.255.255.252 (/30) | -           | 2000:0:520:2222::2  | /112        | fe80::2        |
|              | Loopback0  | -               | 172.16.255.25   | 255.255.255.255(/32)  | -           | fd00:172:16:255::25   | /128        | fe80::1        |
| R26          | e0/0       | l3:to-R24       | 10.64.52.10   | 255.255.255.252 (/30) | -           | fd00:0:24:26::2     | /112        | fe80::1        |
|              | e0/1       | l3:to-CHKR      | 3.3.3.2       | 255.255.255.252 (/30) | -           | 2000:0:520:3333::2  | /112        | fe80::1        |
|              | e0/2       | l3:to-R25       | 10.64.52.14   | 255.255.255.252 (/30) | -           | fd00:0:25:26::2     | /112        | fe80::1        |
|              | e0/3       | l3:to-AS-2042   | 26.100.40.1   | 255.255.255.252 (/30) | -           | 2000:0:2042:520::1  | /112        | fe80::1        |
|              | Loopback0  | -               | 172.16.255.26   | 255.255.255.255(/32)  | -           | fd00:172:16:255::26   | /128        | fe80::1        |
|              |            |                 | *Лабытнанги*    |                       |             |                     |             |                |
| Hostname     | Interfaces | Description     | IPv4-address  | Mask                  | Gateway     | IPv6-address        | IPv6-prefix | LLIPv6-address |
| R27          | e0/0       | l3:to-AS-520    | 1.1.1.1       | 255.255.255.252 (/30) | -           | 2000:0:520:1111::1  | /112        | fe80::1        |
|              | Loopback0  | -               | 172.16.255.27   | 255.255.255.255(/32)  | -           | fd00:172:16:255::27   | /128        | fe80::1        |
|              | Tunnel1  | -               | 10.0.1.2   | 255.255.255.0(/24)  | -           |   |         |         |
|              |            |                 | *С.-Петербург*  |                       |             |                     |             |                |
| Hostname     | Interfaces | Description     | IPv4-address  | Mask                  | Gateway     | IPv6-address        | IPv6-prefix | LLIPv6-address |
| R16          | e0/0.200   | MANAGEMENT_SPB  | 10.58.200.2   | 255.255.255.0 (/24)   | -           | fd00:10:58:200::1   | /64         | fe80::1        |
|              | e0/2.20    | DHCP_SPB        | 192.168.20.2  | 255.255.255.0 (/24)   | -           | fd00:192:168:20::1  | /64         | fe80::1        |
|              | e0/1       | l3:to-R18       | 10.64.20.6    | 255.255.255.252 (/30) | -           | fd00:0:16:18::2     | /112        | fe80::2        |
|              | e0/3       | l3:to-R32       | 10.64.20.9    | 255.255.255.252 (/30) | -           | fd00:0:16:32::1     | /112        | fe80::1        |
| R17          | e0/0.200   | MANAGEMENT_SPB  | 10.58.200.3   | 255.255.255.0 (/24)   | -           | fd00:10:58:200::1   | /64         | fe80::1        |
|              | e0/2.20    | DHCP_SPB        | 192.168.20.3  | 255.255.255.0 (/24)   | -           | fd00:192:168:200::1 | /64         | fe80::1        |
|              | e0/1       | l3:to-R18       | 10.64.20.2    | 255.255.255.252 (/30) | -           | fd00:0:17:18::2     | /112        | fe80::2        |
| R18          | e0/0       | l3:to-R16       | 10.64.20.5    | 255.255.255.252 (/30) | -           | fd00:0:16:18::1     | /112        | fe80::1        |
|              | e0/1       | l3:to-R17       | 10.64.20.1    | 255.255.255.252 (/30) | -           | fd00:0:17:18::1     | /112        | fe80::1        |
|              | e0/2       | l3:to-AS-520    | 24.100.40.6   | 255.255.255.252 (/30) | -           | 2000:0:520:2042::2  | /112        | fe80::1        |
|              | e0/3       | l3:to-AS-520    | 26.100.40.2   | 255.255.255.252 (/30) | -           | 2000:0:2042:520::2  | /112        | fe80::2        |
|              | Loopback1  | to_NAT               | 53.17.29.18   | 255.255.255.0(/24)  | -           |   |         |         |
|              | Tunnel0  | -               | 10.0.0.2   | 255.255.255.0(/24)  | -           |   |         |         |
| R32          | e0/0       | l3:to-R16       | 10.64.20.10   | 255.255.255.252 (/30) | -           | fd00:0:16:32::2     | /112        | fe80::2        |
| VRRP_R16+R17 | -          | MANAGEMENT_SPB  | 10.58.200.1   | 255.255.255.0 (/24)   | -           | -                   | -           | -              |
|              | -          | DHCP_SPB        | 192.168.20.1  | 255.255.255.0 (/24)   | -           | -                   | -           | -              |
| SW9          | VLAN200    | MANAGEMENT_SPB  | 10.58.200.109 | 255.255.255.0 (/24)   | 10.58.200.1 | fd00:10:58:200::9   | /64         | fe80::9        |
| SW10         | VLAN200    | MANAGEMENT_SPB  | 10.58.200.110 | 255.255.255.0 (/24)   | 10.58.200.1 | fd00:10:58:200::10  | /64         | fe80::10       |
| VPC          | NIC        | -               | DHCP          | DHCP                  | DHCP        | -                   | -           | -              |
| VPC8         | NIC        | -               | DHCP          | DHCP                  | DHCP        | -                   | -           | -              |
|              |            |                 | *Чокурдах*      |                       |             |                     |             |                |
| Hostname     | Interfaces | Description     | IPv4-address  | Mask                  | Gateway     | IPv6-address        | IPv6-prefix | LLIPv6-address |
| R28          | e0/2.100   | MANAGEMENT_CHKR | 10.58.10.1    | 255.255.255.0 (/24)   | -           | fd00:10:58:10::1    | /64         | fe80::1        |
|              | e0/2.10    | DHCP_CHKR       | 192.168.100.1 | 255.255.255.0 (/24)   | -           | fd00:192:168:100::1 | /64         | fe80::1        |
|              | e0/0       | l3:to-AS-520    | 3.3.3.1       | 255.255.255.252 (/30) | -           | 2000:0:520:3333::1  | /112        | fe80::2        |
|              | e0/1       | l3:to-AS-520    | 2.2.2.1       | 255.255.255.252 (/30) | -           | 2000:0:520:2222::1  | /112        | fe80::1        |
|              | Loopback0  | -               | 172.16.255.28   | 255.255.255.255(/32)  | -           | fd00:172:16:255::28   | /128        | fe80::1     
|              | Loopback1  | to_NAT               | 63.47.15.28   | 255.255.255.0(/24)  | -           |   |         |         |
|              | Tunnel1  | -               | 10.0.1.3   | 255.255.255.0(/24)  | -           |   |         |         |
| SW29         | VLAN100    | MANAGEMENT_CHKR | 10.58.10.129  | 255.255.255.0 (/24)   | 10.58.10.1  | fd00:10:58:10::29   | /64         | fe80::29       |
| VPC30        | -          | -               | DHCP          | DHCP                  | DHCP        | -                   | -           | -              |
| VPC31        | -          | -               | DHCP          | DHCP                  | DHCP        | -                   | -           | -              |

### Таблица VLAN

| Офис         | VLAN-№ | VLAN-NAME       |
| ------------ | ------ | --------------- |
| Москва       | 10     | DHCP_MSK        |
|              | 100    | MANAGEMENT_MSK  |
| С.-Петербург | 20     | DHCP_SPB        |
|              | 200    | MANAGEMENT_SPB  |
| Чокурдах     | 10     | DHCP_CHKR       |
|              | 100    | MANAGEMENT_CHKR |

- Ниже представлены шаги по настройке оборудования, использующегося в сети офиса Москва:

1. [Разработаем и задокументируем адресное пространство для лабораторного стенда;](https://github.com/Pekep97/Labs/tree/main/Lab_04#1-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D0%B5%D0%BC-%D0%B8-%D0%B7%D0%B0%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B8%D1%80%D1%83%D0%B5%D0%BC-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%BD%D0%BE%D0%B5-%D0%BF%D1%80%D0%BE%D1%81%D1%82%D1%80%D0%B0%D0%BD%D1%81%D1%82%D0%B2%D0%BE-%D0%B4%D0%BB%D1%8F-%D0%BB%D0%B0%D0%B1%D0%BE%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%BD%D0%BE%D0%B3%D0%BE-%D1%81%D1%82%D0%B5%D0%BD%D0%B4%D0%B0)
2. [Настроим ip адреса на каждом активном порту;](https://github.com/Pekep97/Labs/tree/main/Lab_04#2-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-ip-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0-%D0%BD%D0%B0-%D0%BA%D0%B0%D0%B6%D0%B4%D0%BE%D0%BC-%D0%B0%D0%BA%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D0%BC-%D0%BF%D0%BE%D1%80%D1%82%D1%83)
3. [Настроим каждый VPC в каждом офисе в своем VLAN;](https://github.com/Pekep97/Labs/tree/main/Lab_04#3-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D0%BA%D0%B0%D0%B6%D0%B4%D1%8B%D0%B9-vpc-%D0%B2-%D0%BA%D0%B0%D0%B6%D0%B4%D0%BE%D0%BC-%D0%BE%D1%84%D0%B8%D1%81%D0%B5-%D0%B2-%D1%81%D0%B2%D0%BE%D0%B5%D0%BC-vlan)
4. [Настроим VLAN/Loopbackup interface управления для сетевых устройств;](https://github.com/Pekep97/Labs/tree/main/Lab_04#4-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-vlanloopbackup-interface-%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B4%D0%BB%D1%8F-%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D1%85-%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2)
5. [Настроим сети офисов так, чтобы не возникало broadcast штормов, а использование линков было максимально оптимизировано и задокументируем все изменения.](https://github.com/Pekep97/Labs/tree/main/Lab_04#5-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D1%81%D0%B5%D1%82%D0%B8-%D0%BE%D1%84%D0%B8%D1%81%D0%BE%D0%B2-%D1%82%D0%B0%D0%BA-%D1%87%D1%82%D0%BE%D0%B1%D1%8B-%D0%BD%D0%B5-%D0%B2%D0%BE%D0%B7%D0%BD%D0%B8%D0%BA%D0%B0%D0%BB%D0%BE-broadcast-%D1%88%D1%82%D0%BE%D1%80%D0%BC%D0%BE%D0%B2-%D0%B0-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BB%D0%B8%D0%BD%D0%BA%D0%BE%D0%B2-%D0%B1%D1%8B%D0%BB%D0%BE-%D0%BC%D0%B0%D0%BA%D1%81%D0%B8%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE-%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BE-%D0%B8-%D0%B7%D0%B0%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B8%D1%80%D1%83%D0%B5%D0%BC-%D0%B2%D1%81%D0%B5-%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F)
6. [Настроим маршрутизаторы R14-R15 в зоне 0 - backbone;](https://github.com/Pekep97/Labs/tree/main/Lab_06#1-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%82%D0%BE%D1%80%D1%8B-r14-r15-%D0%B2-%D0%B7%D0%BE%D0%BD%D0%B5-0---backbone)
7. [Настроим маршрутизаторы R12-R13 в зоне 10. Дополнительно к маршрутам будут получать маршрут по умолчанию;](https://github.com/Pekep97/Labs/tree/main/Lab_06#2-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%82%D0%BE%D1%80%D1%8B-r12-r13-%D0%B2-%D0%B7%D0%BE%D0%BD%D0%B5-10-%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE-%D0%BA-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B0%D0%BC-%D0%B1%D1%83%D0%B4%D1%83%D1%82-%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B0%D1%82%D1%8C-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82-%D0%BF%D0%BE-%D1%83%D0%BC%D0%BE%D0%BB%D1%87%D0%B0%D0%BD%D0%B8%D1%8E)
8. [Настроим маршрутизатор R19 в зоне 101 и будет получать только маршрут по умолчанию;](https://github.com/Pekep97/Labs/tree/main/Lab_06#3-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%82%D0%BE%D1%80-r19-%D0%B2-%D0%B7%D0%BE%D0%BD%D0%B5-101-%D0%B8-%D0%B1%D1%83%D0%B4%D0%B5%D1%82-%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B0%D1%82%D1%8C-%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82-%D0%BF%D0%BE-%D1%83%D0%BC%D0%BE%D0%BB%D1%87%D0%B0%D0%BD%D0%B8%D1%8E)
9. [Настроим маршрутизатор R20 в зоне 102 и будет получать все маршруты, кроме маршрутов до сетей зоны 101. Задокументируем все изменения.](https://github.com/Pekep97/Labs/tree/main/Lab_06#4-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%82%D0%BE%D1%80-r20-%D0%B2-%D0%B7%D0%BE%D0%BD%D0%B5-102-%D0%B8-%D0%B1%D1%83%D0%B4%D0%B5%D1%82-%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B0%D1%82%D1%8C-%D0%B2%D1%81%D0%B5-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D1%8B-%D0%BA%D1%80%D0%BE%D0%BC%D0%B5-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%BE%D0%B2-%D0%B4%D0%BE-%D1%81%D0%B5%D1%82%D0%B5%D0%B9-%D0%B7%D0%BE%D0%BD%D1%8B-101-%D0%B7%D0%B0%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B8%D1%80%D1%83%D0%B5%D0%BC-%D0%B2%D1%81%D0%B5-%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F)
10. [Настроим eBGP между офисом Москва и двумя провайдерами - Киторн и Ламас;](https://github.com/Pekep97/Labs/tree/main/Lab_09#1-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-ebgp-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D0%BE%D1%84%D0%B8%D1%81%D0%BE%D0%BC-%D0%BC%D0%BE%D1%81%D0%BA%D0%B2%D0%B0-%D0%B8-%D0%B4%D0%B2%D1%83%D0%BC%D1%8F-%D0%BF%D1%80%D0%BE%D0%B2%D0%B0%D0%B9%D0%B4%D0%B5%D1%80%D0%B0%D0%BC%D0%B8---%D0%BA%D0%B8%D1%82%D0%BE%D1%80%D0%BD-%D0%B8-%D0%BB%D0%B0%D0%BC%D0%B0%D1%81)
11. [Настроим iBGP в офисе Москва между маршрутизаторами R14 и R15;](https://github.com/Pekep97/Labs/tree/main/Lab_10#1-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-ibgp-%D0%B2-%D0%BE%D1%84%D0%B8%D1%81%D0%B5-%D0%BC%D0%BE%D1%81%D0%BA%D0%B2%D0%B0-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%82%D0%BE%D1%80%D0%B0%D0%BC%D0%B8-r14-%D0%B8-r15)
12. [Настроим офис Москва так, чтобы приоритетным провайдером стал Ламас;](https://github.com/Pekep97/Labs/tree/main/Lab_10#3-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D0%BE%D1%84%D0%B8%D1%81-%D0%BC%D0%BE%D1%81%D0%BA%D0%B2%D0%B0-%D1%82%D0%B0%D0%BA-%D1%87%D1%82%D0%BE%D0%B1%D1%8B-%D0%BF%D1%80%D0%B8%D0%BE%D1%80%D0%B8%D1%82%D0%B5%D1%82%D0%BD%D1%8B%D0%BC-%D0%BF%D1%80%D0%BE%D0%B2%D0%B0%D0%B9%D0%B4%D0%B5%D1%80%D0%BE%D0%BC-%D1%81%D1%82%D0%B0%D0%BB-%D0%BB%D0%B0%D0%BC%D0%B0%D1%81)
13. [Настроим фильтрацию в офисе Москва так, чтобы не появилось транзитного трафика(As-path);](https://github.com/Pekep97/Labs/blob/main/Lab_11/README.md#%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5)
14. [Настроим NAT(PAT) на R14 и R15. Трансляция осуществляется в адрес автономной системы AS1001;](https://github.com/Pekep97/Labs/tree/main/Lab_12#1-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-natpat-%D0%BD%D0%B0-r14-%D0%B8-r15-%D1%82%D1%80%D0%B0%D0%BD%D1%81%D0%BB%D1%8F%D1%86%D0%B8%D1%8F-%D0%BE%D1%81%D1%83%D1%89%D0%B5%D1%81%D1%82%D0%B2%D0%BB%D1%8F%D0%B5%D1%82%D1%81%D1%8F-%D0%B2-%D0%B0%D0%B4%D1%80%D0%B5%D1%81-%D0%B0%D0%B2%D1%82%D0%BE%D0%BD%D0%BE%D0%BC%D0%BD%D0%BE%D0%B9-%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B-as1001)
15. [Настроим статический NAT для R20;](https://github.com/Pekep97/Labs/tree/main/Lab_12#3-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9-nat-%D0%B4%D0%BB%D1%8F-r20)
16. [Настроим NAT так, чтобы R19 был доступен с любого узла для удаленного управления;](https://github.com/Pekep97/Labs/tree/main/Lab_12#4-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-nat-%D1%82%D0%B0%D0%BA-%D1%87%D1%82%D0%BE%D0%B1%D1%8B-r19-%D0%B1%D1%8B%D0%BB-%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B5%D0%BD-%D1%81-%D0%BB%D1%8E%D0%B1%D0%BE%D0%B3%D0%BE-%D1%83%D0%B7%D0%BB%D0%B0-%D0%B4%D0%BB%D1%8F-%D1%83%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE-%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F)
  - 16*. [Настроим статический NAT(PAT) для офиса Чокурдах;](https://github.com/Pekep97/Labs/tree/main/Lab_12#4-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9-natpat-%D0%B4%D0%BB%D1%8F-%D0%BE%D1%84%D0%B8%D1%81%D0%B0-%D1%87%D0%BE%D0%BA%D1%83%D1%80%D0%B4%D0%B0%D1%85)
17. [Настроим для IPv4 DHCP сервер в офисе Москва на маршрутизаторах R12 и R13. VPC1 и VPC7 получают сетевые настройки по DHCP;](https://github.com/Pekep97/Labs/tree/main/Lab_12#5-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-%D0%B4%D0%BB%D1%8F-ipv4-dhcp-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80-%D0%B2-%D0%BE%D1%84%D0%B8%D1%81%D0%B5-%D0%BC%D0%BE%D1%81%D0%BA%D0%B2%D0%B0-%D0%BD%D0%B0-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%82%D0%BE%D1%80%D0%B0%D1%85-r12-%D0%B8-r13-vpc1-%D0%B8-vpc7-%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B0%D1%8E%D1%82-%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D0%B5-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B8-%D0%BF%D0%BE-dhcp)
18. [Настроим NTP сервер на R12 и R13. Все устройства в офисе Москва синхронизируют время с R12 и R13;](https://github.com/Pekep97/Labs/tree/main/Lab_12#6-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-ntp-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80-%D0%BD%D0%B0-r12-%D0%B8-r13-%D0%B2%D1%81%D0%B5-%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B0-%D0%B2-%D0%BE%D1%84%D0%B8%D1%81%D0%B5-%D0%BC%D0%BE%D1%81%D0%BA%D0%B2%D0%B0-%D1%81%D0%B8%D0%BD%D1%85%D1%80%D0%BE%D0%BD%D0%B8%D0%B7%D0%B8%D1%80%D1%83%D1%8E%D1%82-%D0%B2%D1%80%D0%B5%D0%BC%D1%8F-%D1%81-r12-%D0%B8-r13)
19. [Настроим GRE между офисами Москва и С.-Петербург;](https://github.com/Pekep97/Labs/tree/main/Lab_13#1-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-gre-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D0%BE%D1%84%D0%B8%D1%81%D0%B0%D0%BC%D0%B8-%D0%BC%D0%BE%D1%81%D0%BA%D0%B2%D0%B0-%D0%B8-%D1%81-%D0%BF%D0%B5%D1%82%D0%B5%D1%80%D0%B1%D1%83%D1%80%D0%B3)
20. [Настроим DMVMN между Москва и Чокурдах, Лабытнанги;](https://github.com/Pekep97/Labs/tree/main/Lab_13#2-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B8%D0%BC-dmvmn-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-%D0%BC%D0%BE%D1%81%D0%BA%D0%B2%D0%B0-%D0%B8-%D1%87%D0%BE%D0%BA%D1%83%D1%80%D0%B4%D0%B0%D1%85-%D0%BB%D0%B0%D0%B1%D1%8B%D1%82%D0%BD%D0%B0%D0%BD%D0%B3%D0%B8)

- В процессе настройки оборудования выявлены следующие проблемы сети офиса Москва:
    *  Сложность масштабирования и возможность появления L2 петель;
    *  Вероятность возникновения петли маршрутизации на выходе из AS;
    *  Отсутствие прямой связи между R14 и R15 в рамках передачи маршрутной информации;
    *  Размытая иерархия сети.
 
- Прослушав курс Network Engineer, пришло понимание того, как можно исправить описанные недочеты.
- В рамках рассмотрения вопросов оптимизации сети обнаружено, что в маршрутизаторах R12 и R13 имеются незадействованные портовые платы, которые были перенесены в R14 и R15. На следующем шаге были заменены коммутаторы L2 SW2-SW5 на коммутаторы L3. Один из удаленных коммутаторов остался в схеме под именем SW1 для обеспечения возможности организации технологии *резервирования шлюза* (протокол VRRP перенесен с R12, R13 на SW2, SW3).
- Проблема L3 петель на выходе из AS Москвы возникала из-за того, что в сети транслировалось два маршрута по умолчанию в протоколе OSPF с маршрутизаторов R14, R15, а выход из AS был разрешен только с R15. Возникали ситуации, когда, например, ***трафик пришел на R13, который воспринимает в качестве шлюза R14. R13 отправляет его на R14, но в то же время, из-за отсутствия прямой связи R14 и R15, R14 знает, что до R15 ему проще добраться через R13 и отправляет трафик обратно. Процесс продолжается до тех пор, пока не обнулится TTL***. Данную проблему можно решить, если убрать с R14 вещание маршрута по умолчанию, но в случае возникновения нештатной ситуации придется возвращать настройки вручную. Данный нюанс можно разрешить с помощью PBR на R12 и R13, но этот вариант нам не подходит.

- После перестановки платы появилась возможность реорганизовать топологию и привести ее к следующему виду:

### Таблица адресного пространства:

|              |            |                 | *Москва*        |                       |             |                     |             |                |
|--------------|------------|-----------------|---------------|-----------------------|-------------|---------------------|-------------|----------------|
| Hostname     | Interfaces | Description     | IPv4-address  | Mask                  | Gateway     | IPv6-address        | IPv6-prefix | LLIPv6-address |
| R12          | e0/0   | l3:to-SW4  | 10.58.100.1   | 255.255.255.252 (/30)   | -           | FD00:0:12:4::1   | /112         | fe80::1        |
|              | e0/1    | l3:to-R15        | 10.64.100.5  | 255.255.255.252 (/30)   | -           | FD00:0:12:15::1  | /112         | fe80::1        |
|              | e0/2       | l3:to-R14       | 10.64.100.1   | 255.255.255.252 (/30) | -           | fd00:0:12:14::1     | /112        | fe80::1        |
|              | e0/3       | l3:to-R15       | 10.64.100.5   | 255.255.255.252 (/30) | -           | fd00:0:12:15::1     | /112        | fe80::1        |
|              | Loopback0  | BGP_1001        | 172.16.255.12   | 255.255.255.255(/32)  | -           | FD00:172:16:255::12  | /128        |   fe80::1   |
| R13          | e0/0   | l3:to-SW5  | 10.58.100.5   | 255.255.255.252 (/30)   | -           | FD00:0:13:5::1   | /112         | fe80::1      |
|              | e0/1    | l3:to-R14        | 10.64.100.9  | 255.255.255.0 (/24)   | -           | FD00:0:13:14::1  | /112         | fe80::1       |
|              | e0/2       | l3:to-R15       | 10.64.100.13  | 255.255.255.252 (/30) | -           | fd00:0:13:15::1     | /112        | fe80::1        |
|              | e0/3       | l3:to-R14       | 10.64.100.9   | 255.255.255.252 (/30) | -           | fd00:0:13:14::1     | /112        | fe80::1        |
|              | Loopback0  | BGP_1001        | 172.16.255.13   | 255.255.255.255(/32)  | -           | FD00:172:16:255::13  | /128         |  fe80::1       |
| R14          | e0/0       | l3:to-R12       | 10.64.100.2   | 255.255.255.252 (/30) | -           | fd00:0:12:14::2     | /112        | fe80::2        |
|              | e0/1       | l3:to-R15       | 10.64.100.13  | 255.255.255.252 (/30) | -           | fd00:0:13:14::2     | /112        | fe80::2        |
|              | e1/0       | l3:to-R13       | 10.64.100.25  | 255.255.255.252 (/30) | -           | FD00:0:15:14::2     | /112        | fe80::2        |
|              | e0/2       | l3:to-AS-101    | 85.10.22.2    | 255.255.255.252 (/30) | -           | 2000:0:1001:101::2  | /112        | fe80::2        |
|              | e0/3       | l3:to-R19       | 10.64.100.21  | 255.255.255.252 (/30) | -           | fd00:0:14:19::1     | /112        | fe80::2        |
|              | Loopback0  | BGP_1001        | 172.16.255.14   | 255.255.255.255(/32)  | -           | fd00:172:16:255::14   | /128        | fe80::1    |
|              | Loopback1  | to_NAT               | 49.28.35.14   | 255.255.255.0(/24)  | -           |   |         |         |
| R15          | e0/0       | l3:to-R13       | 10.64.100.14  | 255.255.255.252 (/30) | -           | fd00:0:13:15::2     | /112        | fe80::2        |
|              | e0/1       | l3:to-R12       | 10.64.100.6   | 255.255.255.252 (/30) | -           | fd00:0:12:15::2     | /112        | fe80::2        |
|              | e0/2       | l3:to-AS-301    | 132.50.21.2   | 255.255.255.252 (/30) | -           | 2000:0:1001:301::2  | /112        | fe80::2        |
|              | e0/3       | l3:to-R20       | 10.64.100.17  | 255.255.255.252 (/30) | -           | fd00:0:15:20::1     | /112        | fe80::2        |
|              | e1/0       | l3:to-R14       | 10.64.100.26   | 255.255.255.252 (/30) | -           | FD00:0:15:14::1     | /112        | fe80::1        |
|              | Loopback0  | -               | 172.16.255.15   | 255.255.255.255(/32)  | -           | fd00:172:16:255::15   | /128        | fe80::1        |
|              | Loopback1  | to_NAT               | 37.85.13.15   | 255.255.255.0(/24)  | -           |   |         |         |
|              | Tunnel0  | -               | 10.0.0.1   | 255.255.255.0(/24)  | -           |   |         |         |
|              | Tunnel1  | -               | 10.0.1.1   | 255.255.255.0(/24)  | -           |   |         |         |
| R19          | e0/0       | l3:to-R14       | 10.64.100.22  | 255.255.255.252 (/30) | -           | fd00:0:14:19::2     | /112        | fe80::1        |
| R20          | e0/0       | l3:to-R15       | 10.64.100.18  | 255.255.255.252 (/30) | -           | fd00:0:15:20::2     | /112        | fe80::1        |
| SW2          | VLAN10    | DHCP_MSK  | 192.168.10.2  | 255.255.255.0 (/24)   | - | -   | -         | -        |
|              | e0/0       | l3:to-SW5       | 10.58.100.18   | 255.255.255.252 (/30) | -           | FD00:0:5:2::2     | /112        | fe80::2        |
|              | e0/1       | l3:to-SW4       |  10.58.100.26   | 255.255.255.252 (/30) | -           | FD00:0:4:2::2     | /112        | fe80::2        |
|              | e0/2       | l2:to-corporate       | -   | - | -           | -     | -        | -        |
|              | Loopback0      | BGP_1001       | 172.16.255.2   | 255.255.255.255 (/32) | -           | FD00:172:16:255::2     | /128        | fe80::1        |
| VRRP_SW2+SW3             | -          | DHCP_MSK        | 192.168.10.1  | 255.255.255.0 (/24)   | -           | -                   | -           | -              |
| SW3          | VLAN10    | DHCP_MSK  | 192.168.10.3  | 255.255.255.0 (/24)   | - | -   | -         | -        |
|              | e0/0       | l3:to-SW4       | 10.58.100.14   | 255.255.255.252 (/30) | -           | FD00:0:4:3::2     | /112        | fe80::2        |
|              | e0/1       | l3:to-SW5       |  10.58.100.22   | 255.255.255.252 (/30) | -           | FD00:0:5:3::2     | /112        | fe80::2        |
|              | e0/2       | l2:to-corporate       | -   | - | -           | -     | -        | -        |
|              | Loopback0      | BGP_1001       | 172.16.255.3   | 255.255.255.255 (/32) | -           | FD00:172:16:255::3     | /128        | fe80::1        |
| VRRP_SW2+SW3             | -          | DHCP_MSK        | 192.168.10.1  | 255.255.255.0 (/24)   | -           | -                   | -           | -              |
| SW4              | e0/0       |  l3:to-SW3       | 10.58.100.13   | 255.255.255.252 (/30) | -           | FD00:0:4:3::1     | /112        | fe80::1        |
|              | e0/1       | l3:to-SW2       |  10.58.100.25   | 255.255.255.252 (/30) | -           | FD00:0:4:2::1     | /112        | fe80::1        |
|              | e1/0       | l3:to-R12       |  10.58.100.2   | 255.255.255.252 (/30) | -           | FD00:0:12:4::2     | /112        | fe80::2        |
|              | Po45       | -       |  10.58.100.9   | 255.255.255.252 (/30) | -           | FD00:0:4:5::1     | /112        | fe80::1        |
|              | Loopback0      | BGP_1001       | 172.16.255.4   | 255.255.255.255 (/32) | -           | FD00:172:16:255::4     | /128        | fe80::1        |
| SW5              | e0/0       |  l3:to-SW2       | 10.58.100.17   | 255.255.255.252 (/30) | -           | FD00:0:5:2::1     | /112        | fe80::1        |
|              | e0/1       | l3:to-SW3       |  10.58.100.21   | 255.255.255.252 (/30) | -           | FD00:0:5:3::1     | /112        | fe80::1        |
|              | e1/0       | l3:to-R13      |  10.58.100.6   | 255.255.255.252 (/30) | -           | FD00:0:13:5::2     | /112        | fe80::2        |
|              | Po45       | -       |  10.58.100.10   | 255.255.255.252 (/30) | -           | FD00:0:4:5::2     | /112        | fe80::2        |
|              | Loopback0      | BGP_1001       | 172.16.255.5   | 255.255.255.255 (/32) | -           | FD00:172:16:255::5     | /128        | fe80::1        |
| VPC1         | NIC        | -               | DHCP          | DHCP                  | DHCP        | -                   | -           | -              |
| VPC2         | NIC        | -               | DHCP          | DHCP                  | DHCP        | -                   | -           | -              |

### Схема организации OSPF:

![Схема_OSPF](https://github.com/Pekep97/Labs/blob/main/Project/%D0%90%D0%BB%D1%8C%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D0%B0%D1%8F_OSPF.png)

- Добавив интерфейсы ***Loopback*** и настроив IP-адреса согласно [скорректированной таблицы адресации](), настроили OSPF. Это дает возможность организовать IBGP соседство через интерфейсы ***Loopback***, чтобы все L3 устройства знали то, как можно "выйти" из своей AS. В IBGP приоритезация шлюза по умолчанию настраивается гораздо проще. Достаточно на R15 увеличить значение ***Local Preference*** на маршруты, полученные извне (офис Москва получает от вышестоящих провайдеров маршрут по умолчанию, и, если что-то случится с R15, трафик пойдет через R14 без значительных потерь, что обеспечит стабильный выход "в мир").

### Схема организации IBGP:

![Схема_BGP](https://github.com/Pekep97/Labs/blob/main/Project/%D0%90%D0%BB%D1%8C%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D0%B0%D1%8F_BGP.png)

- Создано два кластера RR (R14 является RR-сервером для всех, кроме R20, R15 является RR-сервером для всех, кроме R19). Логика в слеующем: если что-то случится с R14 или с линией между R14 и R19, то R19 будет недоступен в любом случае. Именно поэтому настройка соседства с ними нецелесообразна (решение данной проблемы не приводится в проекте).
- NTP и DHCP-серверы остаются на R12 и R13, что позволяет не переделывать всю сеть. Достаточно только настроить на SW2 и SW3 DHCP-relay на ***Loopback***-интерфейсы R12 и R13.
- Ниже приведена конфигурация маршрутизаторов R14 и R15 до изменений и после. Будет наглядно видно то, как увеличился блок настроек BGP, но данная манипуляция производится один раз и работает в дальнейшем без дополнительного вмешательства.

### ДО

***R14***
```
R14#sh run
Building configuration...

Current configuration : 4921 bytes
!
! Last configuration change at 14:55:03 MSK Wed Feb 21 2024 by admin
! NVRAM config last updated at 15:20:07 MSK Wed Feb 21 2024 by admin
!
version 15.4
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname R14
!
boot-start-marker
boot-end-marker
!
enable secret 5 $1$/yqZ$WE/0YR0XnODtDBsZeUD1j/
!
no aaa new-model
clock timezone MSK 3 0
mmi polling-interval 60
no mmi auto-configure
no mmi pvc
mmi snmp-timeout 180
!
ip cef
ipv6 unicast-routing
ipv6 cef
!
multilink bundle-name authenticated
!
username admin privilege 15 secret 5 $1$U/Md$PI1HGnXQGVMa2VSKDea6M.
!
redundancy
!
interface Loopback0
 ip address 172.16.255.14 255.255.255.255
 ip ospf 1 area 0
 ipv6 address FE80::1 link-local
 ipv6 address FD00:172:16:255::14/128
 ipv6 enable
 ipv6 ospf 1 area 0
!
interface Loopback1
 ip address 49.28.35.14 255.255.255.0
 ip nat enable
!
interface Ethernet0/0
 description l3:to-R12
 ip address 10.64.100.2 255.255.255.252
 ip nat enable
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:12:14::2/112
 ipv6 enable
 ipv6 ospf 1 area 0
 ipv6 ospf network point-to-point
!
interface Ethernet0/1
 description l3:to-R13
 ip address 10.64.100.10 255.255.255.252
 ip nat enable
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:13:14::2/112
 ipv6 enable
 ipv6 ospf 1 area 0
 ipv6 ospf network point-to-point
!
interface Ethernet0/2
 description l3:to-AS-101
 ip address 85.10.22.2 255.255.255.252
 ip nat enable
 ipv6 address FE80::2 link-local
 ipv6 address 2000:0:1001:101::2/112
 ipv6 enable
!
interface Ethernet0/3
 description l3:to-R19
 ip address 10.64.100.21 255.255.255.252
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:14:19::1/112
 ipv6 enable
 ipv6 ospf 1 area 101
 ipv6 ospf network point-to-point
!
router ospf 1
 router-id 14.14.14.14
 area 101 stub no-summary
 passive-interface Ethernet0/2
 network 10.64.100.0 0.0.0.3 area 0
 network 10.64.100.8 0.0.0.3 area 0
 network 10.64.100.20 0.0.0.3 area 101
 network 172.16.255.14 0.0.0.0 area 0
!
router bgp 1001
 bgp router-id 14.14.14.14
 bgp log-neighbor-changes
 neighbor 2000:0:1001:101::1 remote-as 101
 neighbor 85.10.22.1 remote-as 101
 neighbor 172.16.255.15 remote-as 1001
 neighbor 172.16.255.15 update-source Loopback0
 neighbor FD00:172:16:255::15 remote-as 1001
 neighbor FD00:172:16:255::15 update-source Loopback0
 !
 address-family ipv4
  network 10.58.100.0 mask 255.255.255.0
  network 10.64.100.0 mask 255.255.255.224
  network 10.64.100.0 mask 255.255.255.252
  network 10.64.100.4 mask 255.255.255.252
  network 10.64.100.8 mask 255.255.255.252
  network 10.64.100.12 mask 255.255.255.252
  network 10.64.100.20 mask 255.255.255.252
  network 49.28.35.0 mask 255.255.255.0
  network 85.10.22.0 mask 255.255.255.252
  network 172.16.255.14 mask 255.255.255.255
  no neighbor 2000:0:1001:101::1 activate
  neighbor 85.10.22.1 activate
  neighbor 85.10.22.1 next-hop-self
  neighbor 85.10.22.1 soft-reconfiguration inbound
  neighbor 85.10.22.1 route-map AS_PATH_1001_x3 out
  neighbor 85.10.22.1 filter-list 1 out
  neighbor 172.16.255.15 activate
  neighbor 172.16.255.15 next-hop-self
  neighbor 172.16.255.15 soft-reconfiguration inbound
  no neighbor FD00:172:16:255::15 activate
 exit-address-family
 !
 address-family ipv6
  network 2000:0:1001:101::/112
  network FD00:0:12:14::/112
  network FD00:0:12:15::/112
  network FD00:0:13:14::/112
  network FD00:0:13:15::/112
  network FD00:0:14:19::/112
  network FD00:0:15:20::/112
  network FD00:10:58:100::/64
  network FD00:172:16:255::14/128
  network FD00:192:168:10::/64
  neighbor 2000:0:1001:101::1 activate
  neighbor 2000:0:1001:101::1 next-hop-self
  neighbor 2000:0:1001:101::1 soft-reconfiguration inbound
  neighbor 2000:0:1001:101::1 route-map AS_PATH_1001_x3 out
  neighbor 2000:0:1001:101::1 filter-list 1 out
  neighbor FD00:172:16:255::15 activate
  neighbor FD00:172:16:255::15 next-hop-self
 exit-address-family
!
ip forward-protocol nd
!
ip as-path access-list 1 permit ^$
!
no ip http server
no ip http secure-server
ip nat source list NAT interface Loopback1 overload
ip nat source static tcp 10.64.100.22 22 interface Loopback1 22
ip nat source static 10.64.100.18 49.28.35.20
!
ip access-list standard NAT
 permit 192.168.10.0 0.0.0.255
!
ipv6 router ospf 1
 router-id 14.14.14.14
 area 101 stub no-summary
 passive-interface Ethernet0/2
!
route-map AS_PATH_1001_x3 permit 10
 set as-path prepend 1001 1001 1001
!
control-plane
!
banner motd ^C unauthorized access prohibited ^C
!
line con 0
 password cisco
 logging synchronous
 login local
line aux 0
line vty 0 4
 password cisco
 login
 transport input none
!
ntp server 172.16.255.12 source Loopback0
ntp server 172.16.255.13 source Loopback0
!
end
```

***R15***
```

R15#sh run
Building configuration...

Current configuration : 5009 bytes
!
! Last configuration change at 14:18:35 MSK Thu Feb 29 2024 by admin
! NVRAM config last updated at 14:47:25 MSK Thu Feb 29 2024 by admin
!
version 15.4
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname R15
!
boot-start-marker
boot-end-marker
!
enable secret 5 $1$/yqZ$WE/0YR0XnODtDBsZeUD1j/
!
no aaa new-model
clock timezone MSK 3 0
mmi polling-interval 60
no mmi auto-configure
no mmi pvc
mmi snmp-timeout 180
!
ip cef
ipv6 unicast-routing
ipv6 cef
!
multilink bundle-name authenticated
!
username admin privilege 15 secret 5 $1$U/Md$PI1HGnXQGVMa2VSKDea6M.
!
redundancy
!
interface Loopback0
 ip address 172.16.255.15 255.255.255.255
 ipv6 address FE80::1 link-local
 ipv6 address FD00:172:16:255::15/128
 ipv6 enable
 ipv6 ospf 1 area 0
!
interface Loopback1
 description to_NAT
 ip address 37.85.13.15 255.255.255.0
 ip nat enable
!
interface Tunnel0
 ip address 10.0.0.1 255.255.255.0
 ip mtu 1400
 ip tcp adjust-mss 1360
 ip ospf network broadcast
 ip ospf priority 255
 keepalive 10 3
 tunnel source Loopback1
 tunnel destination 53.17.29.18
!
interface Tunnel1
 ip address 10.0.1.1 255.255.255.0
 no ip redirects
 ip mtu 1400
 ip nhrp map multicast dynamic
 ip nhrp network-id 1
 ip tcp adjust-mss 1360
 ip ospf network broadcast
 ip ospf priority 255
 tunnel source Loopback1
 tunnel mode gre multipoint
!
interface Ethernet0/0
 description l3:to-R13
 ip address 10.64.100.14 255.255.255.252
 ip nat enable
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:13:15::2/112
 ipv6 enable
 ipv6 ospf 1 area 0
 ipv6 ospf network point-to-point
!
interface Ethernet0/1
 description l3:to-R12
 ip address 10.64.100.6 255.255.255.252
 ip nat enable
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:12:15::2/112
 ipv6 enable
 ipv6 ospf 1 area 0
 ipv6 ospf network point-to-point
!
interface Ethernet0/2
 description l3:to-AS-301
 ip address 132.50.21.2 255.255.255.252
 ip nat enable
 ipv6 address FE80::2 link-local
 ipv6 address 2000:0:1001:301::2/112
 ipv6 enable
!
interface Ethernet0/3
 description l3:to-R20
 ip address 10.64.100.17 255.255.255.252
 ip nat enable
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:15:20::1/112
 ipv6 enable
 ipv6 ospf 1 area 102
 ipv6 ospf network point-to-point
!
router ospf 1
 router-id 15.15.15.15
 area 102 filter-list prefix area_101_deny in
 passive-interface Ethernet0/2
 network 10.0.0.0 0.0.0.255 area 1000
 network 10.0.1.0 0.0.0.255 area 1001
 network 10.64.100.4 0.0.0.3 area 0
 network 10.64.100.12 0.0.0.3 area 0
 network 10.64.100.16 0.0.0.3 area 102
 network 172.16.255.15 0.0.0.0 area 0
 default-information originate always
!
router bgp 1001
 bgp router-id 15.15.15.15
 bgp log-neighbor-changes
 neighbor 2000:0:1001:301::1 remote-as 301
 neighbor 132.50.21.1 remote-as 301
 neighbor 172.16.255.14 remote-as 1001
 neighbor FD00:172:16:255::14 remote-as 1001
 !
 address-family ipv4
  network 37.85.13.0 mask 255.255.255.0
  network 132.50.21.0 mask 255.255.255.252
  no neighbor 2000:0:1001:301::1 activate
  neighbor 132.50.21.1 activate
  neighbor 132.50.21.1 next-hop-self
  neighbor 132.50.21.1 soft-reconfiguration inbound
  neighbor 132.50.21.1 route-map LP_200 in
  neighbor 132.50.21.1 filter-list 1 out
  neighbor 172.16.255.14 activate
  neighbor 172.16.255.14 next-hop-self
  no neighbor FD00:172:16:255::14 activate
 exit-address-family
 !
 address-family ipv6
  network 2000:0:1001:301::/112
  neighbor 2000:0:1001:301::1 activate
  neighbor 2000:0:1001:301::1 next-hop-self
  neighbor 2000:0:1001:301::1 soft-reconfiguration inbound
  neighbor 2000:0:1001:301::1 route-map LP_200 in
  neighbor 2000:0:1001:301::1 filter-list 1 out
  neighbor FD00:172:16:255::14 activate
  neighbor FD00:172:16:255::14 next-hop-self
 exit-address-family
!
ip forward-protocol nd
!
ip as-path access-list 1 permit ^$
!
no ip http server
no ip http secure-server
ip nat source list NAT interface Loopback1 overload
ip nat source static 10.64.100.18 37.85.13.20
ip nat source static tcp 10.64.100.22 22 37.85.13.22 22 extendable
!
ip access-list standard NAT
 permit 192.168.10.0 0.0.0.255
!
ip prefix-list area_101_deny seq 5 deny 10.64.100.20/30
ip prefix-list area_101_deny seq 10 permit 0.0.0.0/0 le 32
ipv6 router ospf 1
 router-id 15.15.15.15
 area 102 filter-list prefix area_101_deny in
 passive-interface Ethernet0/2
!
ipv6 prefix-list area_101_deny seq 5 deny FD00:0:14:19::/112
ipv6 prefix-list area_101_deny seq 10 permit ::/0 le 128
route-map LP_200 permit 10
 set local-preference 200
!
control-plane
!
banner motd ^C unauthorized access prohibited ^C
!
line con 0
 password cisco
 logging synchronous
 login local
line aux 0
line vty 0 4
 password cisco
 login
 transport input none
!
ntp server 172.16.255.12 source Loopback0
ntp server 172.16.255.13 source Loopback0
!
end
```

### ПОСЛЕ

***R14***
```
R14#sh run
Building configuration...

Current configuration : 8265 bytes
!
! Last configuration change at 23:43:36 MSK Sun Mar 17 2024 by admin
! NVRAM config last updated at 23:45:00 MSK Sun Mar 17 2024 by admin
!
version 15.4
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname R14
!
boot-start-marker
boot-end-marker
!
enable secret 5 $1$/yqZ$WE/0YR0XnODtDBsZeUD1j/
!
no aaa new-model
clock timezone MSK 3 0
mmi polling-interval 60
no mmi auto-configure
no mmi pvc
mmi snmp-timeout 180
!
ip cef
ipv6 unicast-routing
ipv6 cef
!
multilink bundle-name authenticated
!
username admin privilege 15 secret 5 $1$U/Md$PI1HGnXQGVMa2VSKDea6M.
!
redundancy
!
interface Loopback0
 description BGP_1001
 ip address 172.16.255.14 255.255.255.255
 ipv6 address FE80::1 link-local
 ipv6 address FD00:172:16:255::14/128
 ipv6 enable
 ipv6 ospf 1 area 0
!
interface Loopback1
 ip address 49.28.35.14 255.255.255.0
 ip nat enable
!
interface Ethernet0/0
 description l3:to-R12
 ip address 10.64.100.2 255.255.255.252
 ip nat enable
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:12:14::2/112
 ipv6 enable
 ipv6 ospf 1 area 0
 ipv6 ospf network point-to-point
!
interface Ethernet0/1
 description l3:to-R13
 ip address 10.64.100.10 255.255.255.252
 ip nat enable
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:13:14::2/112
 ipv6 enable
 ipv6 ospf 1 area 0
 ipv6 ospf network point-to-point
!
interface Ethernet0/2
 description l3:to-AS-101
 ip address 85.10.22.2 255.255.255.252
 ip nat enable
 ipv6 address FE80::2 link-local
 ipv6 address 2000:0:1001:101::2/112
 ipv6 enable
!
interface Ethernet0/3
 description l3:to-R19
 ip address 10.64.100.21 255.255.255.252
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:14:19::1/112
 ipv6 enable
 ipv6 ospf 1 area 101
 ipv6 ospf network point-to-point
!
interface Ethernet1/0
 description l3:to-R15
 ip address 10.64.100.25 255.255.255.252
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:15:14::2/112
 ipv6 enable
 ipv6 ospf 1 area 0
!
interface Ethernet1/1
 no ip address
 shutdown
!
interface Ethernet1/2
 no ip address
 shutdown
!
interface Ethernet1/3
 no ip address
 shutdown
!
router ospf 1
 router-id 14.14.14.14
 area 101 stub no-summary
 passive-interface Ethernet0/2
 network 10.64.100.0 0.0.0.3 area 0
 network 10.64.100.8 0.0.0.3 area 0
 network 10.64.100.20 0.0.0.3 area 101
 network 10.64.100.24 0.0.0.3 area 0
 network 172.16.255.14 0.0.0.0 area 0
!
router bgp 1001
 bgp router-id 14.14.14.14
 bgp cluster-id 2
 bgp log-neighbor-changes
 neighbor 2000:0:1001:101::1 remote-as 101
 neighbor 85.10.22.1 remote-as 101
 neighbor 172.16.255.2 remote-as 1001
 neighbor 172.16.255.2 update-source Loopback0
 neighbor 172.16.255.2 timers 20 60
 neighbor 172.16.255.3 remote-as 1001
 neighbor 172.16.255.3 update-source Loopback0
 neighbor 172.16.255.3 timers 20 60
 neighbor 172.16.255.4 remote-as 1001
 neighbor 172.16.255.4 update-source Loopback0
 neighbor 172.16.255.4 timers 20 60
 neighbor 172.16.255.5 remote-as 1001
 neighbor 172.16.255.5 update-source Loopback0
 neighbor 172.16.255.5 timers 20 60
 neighbor 172.16.255.12 remote-as 1001
 neighbor 172.16.255.12 update-source Loopback0
 neighbor 172.16.255.12 timers 20 60
 neighbor 172.16.255.13 remote-as 1001
 neighbor 172.16.255.13 update-source Loopback0
 neighbor 172.16.255.13 timers 20 60
 neighbor 172.16.255.15 remote-as 1001
 neighbor 172.16.255.15 update-source Loopback0
 neighbor 172.16.255.15 timers 20 60
 neighbor 172.16.255.19 remote-as 1001
 neighbor 172.16.255.19 update-source Loopback0
 neighbor 172.16.255.19 timers 20 60
 neighbor FD00:172:16:255::2 remote-as 1001
 neighbor FD00:172:16:255::2 update-source Loopback0
 neighbor FD00:172:16:255::2 timers 20 60
 neighbor FD00:172:16:255::3 remote-as 1001
 neighbor FD00:172:16:255::3 update-source Loopback0
 neighbor FD00:172:16:255::3 timers 20 60
 neighbor FD00:172:16:255::4 remote-as 1001
 neighbor FD00:172:16:255::4 update-source Loopback0
 neighbor FD00:172:16:255::4 timers 20 60
 neighbor FD00:172:16:255::5 remote-as 1001
 neighbor FD00:172:16:255::5 update-source Loopback0
 neighbor FD00:172:16:255::5 timers 20 60
 neighbor FD00:172:16:255::12 remote-as 1001
 neighbor FD00:172:16:255::12 update-source Loopback0
 neighbor FD00:172:16:255::12 timers 20 60
 neighbor FD00:172:16:255::13 remote-as 1001
 neighbor FD00:172:16:255::13 update-source Loopback0
 neighbor FD00:172:16:255::13 timers 20 60
 neighbor FD00:172:16:255::15 remote-as 1001
 neighbor FD00:172:16:255::15 update-source Loopback0
 neighbor FD00:172:16:255::15 timers 20 60
 neighbor FD00:172:16:255::19 remote-as 1001
 neighbor FD00:172:16:255::19 update-source Loopback0
 neighbor FD00:172:16:255::19 timers 20 60
 !
 address-family ipv4
  network 49.28.35.0 mask 255.255.255.0
  no neighbor 2000:0:1001:101::1 activate
  neighbor 85.10.22.1 activate
  neighbor 85.10.22.1 next-hop-self
  neighbor 85.10.22.1 soft-reconfiguration inbound
  neighbor 85.10.22.1 route-map AS_PATH_1001_x3 out
  neighbor 85.10.22.1 filter-list 1 out
  neighbor 172.16.255.2 activate
  neighbor 172.16.255.2 route-reflector-client
  neighbor 172.16.255.3 activate
  neighbor 172.16.255.3 route-reflector-client
  neighbor 172.16.255.4 activate
  neighbor 172.16.255.4 route-reflector-client
  neighbor 172.16.255.5 activate
  neighbor 172.16.255.5 route-reflector-client
  neighbor 172.16.255.12 activate
  neighbor 172.16.255.12 route-reflector-client
  neighbor 172.16.255.13 activate
  neighbor 172.16.255.13 route-reflector-client
  neighbor 172.16.255.15 activate
  neighbor 172.16.255.15 route-reflector-client
  neighbor 172.16.255.15 next-hop-self
  neighbor 172.16.255.15 soft-reconfiguration inbound
  neighbor 172.16.255.19 activate
  neighbor 172.16.255.19 route-reflector-client
  no neighbor FD00:172:16:255::2 activate
  no neighbor FD00:172:16:255::3 activate
  no neighbor FD00:172:16:255::4 activate
  no neighbor FD00:172:16:255::5 activate
  no neighbor FD00:172:16:255::12 activate
  no neighbor FD00:172:16:255::13 activate
  no neighbor FD00:172:16:255::15 activate
  no neighbor FD00:172:16:255::19 activate
 exit-address-family
 !
 address-family ipv6
  network 2000:0:1001:101::/112
  neighbor 2000:0:1001:101::1 activate
  neighbor 2000:0:1001:101::1 next-hop-self
  neighbor 2000:0:1001:101::1 soft-reconfiguration inbound
  neighbor 2000:0:1001:101::1 route-map AS_PATH_1001_x3 out
  neighbor 2000:0:1001:101::1 filter-list 1 out
  neighbor FD00:172:16:255::2 activate
  neighbor FD00:172:16:255::2 route-reflector-client
  neighbor FD00:172:16:255::3 activate
  neighbor FD00:172:16:255::3 route-reflector-client
  neighbor FD00:172:16:255::4 activate
  neighbor FD00:172:16:255::4 route-reflector-client
  neighbor FD00:172:16:255::5 activate
  neighbor FD00:172:16:255::5 route-reflector-client
  neighbor FD00:172:16:255::12 activate
  neighbor FD00:172:16:255::12 route-reflector-client
  neighbor FD00:172:16:255::13 activate
  neighbor FD00:172:16:255::13 route-reflector-client
  neighbor FD00:172:16:255::15 activate
  neighbor FD00:172:16:255::15 route-reflector-client
  neighbor FD00:172:16:255::15 next-hop-self
  neighbor FD00:172:16:255::19 activate
  neighbor FD00:172:16:255::19 route-reflector-client
 exit-address-family
!
ip forward-protocol nd
!
ip as-path access-list 1 permit ^$
!
no ip http server
no ip http secure-server
ip nat source list NAT interface Loopback1 overload
ip nat source static tcp 10.64.100.22 22 interface Loopback1 22
ip nat source static 10.64.100.18 49.28.35.20
!
ip access-list standard NAT
 permit 192.168.10.0 0.0.0.255
!
ipv6 router ospf 1
 router-id 14.14.14.14
 area 101 stub no-summary
 passive-interface Ethernet0/2
!
route-map AS_PATH_1001_x3 permit 10
 set as-path prepend 1001 1001 1001
!
control-plane
!
banner motd ^C unauthorized access prohibited ^C
!
line con 0
 password cisco
 logging synchronous
 login local
line aux 0
line vty 0 4
 password cisco
 login
 transport input none
!
ntp server 172.16.255.12 source Loopback0
ntp server 172.16.255.13 source Loopback0
!
end
```

***R15***
```
R15#sh run
Building configuration...

Current configuration : 9034 bytes
!
! Last configuration change at 23:54:58 MSK Sun Mar 17 2024 by admin
! NVRAM config last updated at 23:44:58 MSK Sun Mar 17 2024 by admin
!
version 15.4
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname R15
!
boot-start-marker
boot-end-marker
!
enable secret 5 $1$/yqZ$WE/0YR0XnODtDBsZeUD1j/
!
no aaa new-model
clock timezone MSK 3 0
mmi polling-interval 60
no mmi auto-configure
no mmi pvc
mmi snmp-timeout 180
!
ip cef
ipv6 unicast-routing
ipv6 cef
!
multilink bundle-name authenticated
!
username admin privilege 15 secret 5 $1$U/Md$PI1HGnXQGVMa2VSKDea6M.
!
redundancy
!
interface Loopback0
 description BGP_1001
 ip address 172.16.255.15 255.255.255.255
 ipv6 address FE80::1 link-local
 ipv6 address FD00:172:16:255::15/128
 ipv6 enable
 ipv6 ospf 1 area 0
!
interface Loopback1
 description to_NAT
 ip address 37.85.13.15 255.255.255.0
 ip nat enable
!
interface Tunnel0
 ip address 10.0.0.1 255.255.255.0
 ip mtu 1400
 ip tcp adjust-mss 1360
 ip ospf network broadcast
 ip ospf priority 255
 keepalive 10 3
 tunnel source Loopback1
 tunnel destination 53.17.29.18
!
interface Tunnel1
 ip address 10.0.1.1 255.255.255.0
 no ip redirects
 ip mtu 1400
 ip nhrp map multicast dynamic
 ip nhrp network-id 1
 ip tcp adjust-mss 1360
 ip ospf network broadcast
 ip ospf priority 255
 tunnel source Loopback1
 tunnel mode gre multipoint
!
interface Ethernet0/0
 description l3:to-R13
 ip address 10.64.100.14 255.255.255.252
 ip nat enable
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:13:15::2/112
 ipv6 enable
 ipv6 ospf 1 area 0
 ipv6 ospf network point-to-point
!
interface Ethernet0/1
 description l3:to-R12
 ip address 10.64.100.6 255.255.255.252
 ip nat enable
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:12:15::2/112
 ipv6 enable
 ipv6 ospf 1 area 0
 ipv6 ospf network point-to-point
!
interface Ethernet0/2
 description l3:to-AS-301
 ip address 132.50.21.2 255.255.255.252
 ip nat enable
 ipv6 address FE80::2 link-local
 ipv6 address 2000:0:1001:301::2/112
 ipv6 enable
!
interface Ethernet0/3
 description l3:to-R20
 ip address 10.64.100.17 255.255.255.252
 ip nat enable
 ip ospf network point-to-point
 ipv6 address FE80::2 link-local
 ipv6 address FD00:0:15:20::1/112
 ipv6 enable
 ipv6 ospf 1 area 102
 ipv6 ospf network point-to-point
!
interface Ethernet1/0
 description l3:to-R14
 ip address 10.64.100.26 255.255.255.252
 ip ospf network point-to-point
 ipv6 address FE80::1 link-local
 ipv6 address FD00:0:15:14::1/112
 ipv6 enable
 ipv6 ospf 1 area 0
!
interface Ethernet1/1
 no ip address
 shutdown
!
interface Ethernet1/2
 no ip address
 shutdown
!
interface Ethernet1/3
 no ip address
 shutdown
!
router ospf 1
 router-id 15.15.15.15
 area 102 filter-list prefix area_101_deny in
 passive-interface Ethernet0/2
 network 10.0.0.0 0.0.0.255 area 1000
 network 10.0.1.0 0.0.0.255 area 1001
 network 10.64.100.4 0.0.0.3 area 0
 network 10.64.100.12 0.0.0.3 area 0
 network 10.64.100.16 0.0.0.3 area 102
 network 10.64.100.24 0.0.0.3 area 0
 network 172.16.255.15 0.0.0.0 area 0
 default-information originate always
!
router bgp 1001
 bgp router-id 15.15.15.15
 bgp cluster-id 1
 bgp log-neighbor-changes
 neighbor 2000:0:1001:301::1 remote-as 301
 neighbor 132.50.21.1 remote-as 301
 neighbor 172.16.255.2 remote-as 1001
 neighbor 172.16.255.2 update-source Loopback0
 neighbor 172.16.255.2 timers 20 60
 neighbor 172.16.255.3 remote-as 1001
 neighbor 172.16.255.3 update-source Loopback0
 neighbor 172.16.255.3 timers 20 60
 neighbor 172.16.255.4 remote-as 1001
 neighbor 172.16.255.4 update-source Loopback0
 neighbor 172.16.255.4 timers 20 60
 neighbor 172.16.255.5 remote-as 1001
 neighbor 172.16.255.5 update-source Loopback0
 neighbor 172.16.255.5 timers 20 60
 neighbor 172.16.255.12 remote-as 1001
 neighbor 172.16.255.12 update-source Loopback0
 neighbor 172.16.255.12 timers 20 60
 neighbor 172.16.255.13 remote-as 1001
 neighbor 172.16.255.13 update-source Loopback0
 neighbor 172.16.255.13 timers 20 60
 neighbor 172.16.255.14 remote-as 1001
 neighbor 172.16.255.14 update-source Loopback0
 neighbor 172.16.255.14 timers 20 60
 neighbor 172.16.255.20 remote-as 1001
 neighbor 172.16.255.20 update-source Loopback0
 neighbor 172.16.255.20 timers 20 60
 neighbor FD00:172:16:255::2 remote-as 1001
 neighbor FD00:172:16:255::2 update-source Loopback0
 neighbor FD00:172:16:255::2 timers 20 60
 neighbor FD00:172:16:255::3 remote-as 1001
 neighbor FD00:172:16:255::3 update-source Loopback0
 neighbor FD00:172:16:255::3 timers 20 60
 neighbor FD00:172:16:255::4 remote-as 1001
 neighbor FD00:172:16:255::4 update-source Loopback0
 neighbor FD00:172:16:255::4 timers 20 60
 neighbor FD00:172:16:255::5 remote-as 1001
 neighbor FD00:172:16:255::5 update-source Loopback0
 neighbor FD00:172:16:255::5 timers 20 60
 neighbor FD00:172:16:255::12 remote-as 1001
 neighbor FD00:172:16:255::12 update-source Loopback0
 neighbor FD00:172:16:255::12 timers 20 60
 neighbor FD00:172:16:255::13 remote-as 1001
 neighbor FD00:172:16:255::13 update-source Loopback0
 neighbor FD00:172:16:255::13 timers 20 60
 neighbor FD00:172:16:255::14 remote-as 1001
 neighbor FD00:172:16:255::14 timers 20 60
 neighbor FD00:172:16:255::20 remote-as 1001
 neighbor FD00:172:16:255::20 update-source Loopback0
 neighbor FD00:172:16:255::20 timers 20 60
 !
 address-family ipv4
  network 37.85.13.0 mask 255.255.255.0
  no neighbor 2000:0:1001:301::1 activate
  neighbor 132.50.21.1 activate
  neighbor 132.50.21.1 next-hop-self
  neighbor 132.50.21.1 soft-reconfiguration inbound
  neighbor 132.50.21.1 route-map LP_200 in
  neighbor 132.50.21.1 filter-list 1 out
  neighbor 172.16.255.2 activate
  neighbor 172.16.255.2 route-reflector-client
  neighbor 172.16.255.3 activate
  neighbor 172.16.255.3 route-reflector-client
  neighbor 172.16.255.4 activate
  neighbor 172.16.255.4 route-reflector-client
  neighbor 172.16.255.5 activate
  neighbor 172.16.255.5 route-reflector-client
  neighbor 172.16.255.12 activate
  neighbor 172.16.255.12 route-reflector-client
  neighbor 172.16.255.13 activate
  neighbor 172.16.255.13 route-reflector-client
  neighbor 172.16.255.14 activate
  neighbor 172.16.255.14 route-reflector-client
  neighbor 172.16.255.14 next-hop-self
  neighbor 172.16.255.20 activate
  neighbor 172.16.255.20 route-reflector-client
  no neighbor FD00:172:16:255::2 activate
  no neighbor FD00:172:16:255::3 activate
  no neighbor FD00:172:16:255::4 activate
  no neighbor FD00:172:16:255::5 activate
  no neighbor FD00:172:16:255::12 activate
  no neighbor FD00:172:16:255::13 activate
  no neighbor FD00:172:16:255::14 activate
  no neighbor FD00:172:16:255::20 activate
 exit-address-family
 !
 address-family ipv6
  network 2000:0:1001:301::/112
  neighbor 2000:0:1001:301::1 activate
  neighbor 2000:0:1001:301::1 next-hop-self
  neighbor 2000:0:1001:301::1 soft-reconfiguration inbound
  neighbor 2000:0:1001:301::1 route-map LP_200 in
  neighbor 2000:0:1001:301::1 filter-list 1 out
  neighbor FD00:172:16:255::2 activate
  neighbor FD00:172:16:255::2 route-reflector-client
  neighbor FD00:172:16:255::3 activate
  neighbor FD00:172:16:255::3 route-reflector-client
  neighbor FD00:172:16:255::4 activate
  neighbor FD00:172:16:255::4 route-reflector-client
  neighbor FD00:172:16:255::5 activate
  neighbor FD00:172:16:255::5 route-reflector-client
  neighbor FD00:172:16:255::12 activate
  neighbor FD00:172:16:255::12 route-reflector-client
  neighbor FD00:172:16:255::13 activate
  neighbor FD00:172:16:255::13 route-reflector-client
  neighbor FD00:172:16:255::14 activate
  neighbor FD00:172:16:255::14 route-reflector-client
  neighbor FD00:172:16:255::14 next-hop-self
  neighbor FD00:172:16:255::20 activate
  neighbor FD00:172:16:255::20 route-reflector-client
 exit-address-family
!
ip forward-protocol nd
!
ip as-path access-list 1 permit ^$
!
no ip http server
no ip http secure-server
ip nat source list NAT interface Loopback1 overload
ip nat source static 10.64.100.18 37.85.13.20
ip nat source static tcp 10.64.100.22 22 37.85.13.22 22 extendable
!
ip access-list standard NAT
 permit 192.168.10.0 0.0.0.255
!
ip prefix-list area_101_deny seq 5 deny 10.64.100.20/30
ip prefix-list area_101_deny seq 10 permit 0.0.0.0/0 le 32
ipv6 router ospf 1
 router-id 15.15.15.15
 area 102 filter-list prefix area_101_deny in
 passive-interface Ethernet0/2
!
ipv6 prefix-list area_101_deny seq 5 deny FD00:0:14:19::/112
ipv6 prefix-list area_101_deny seq 10 permit ::/0 le 128
route-map LP_200 permit 10
 set local-preference 200
!
control-plane
!
banner motd ^C unauthorized access prohibited ^C
!
line con 0
 password cisco
 logging synchronous
 login local
line aux 0
line vty 0 4
 password cisco
 login
 transport input none
!
ntp server 172.16.255.12 source Loopback0
ntp server 172.16.255.13 source Loopback0
!
end
```

### Выводы:

1. Оптимизация L2-домена путем его уменьшения решила проблему масштабирования и образования L2-петель;
2. Добавление связей IBGP и формирование кластеров RR привели к минимизации вероятности возникновения петель L3 на выходе из AS;
3. Полносвязная схема Backbone;
4. Сформирована трехуровневая иерархическая сеть.

Все изменения задокументированны [здесь.](https:/github.com/Pekep97/Labs/tree/main/Project/Configs)
